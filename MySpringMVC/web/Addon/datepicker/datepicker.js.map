{"version":3,"sources":["datepicker.es6"],"names":[],"mappings":"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","file":"datepicker.js","sourcesContent":["/**\r\n * demo like below\r\n * <div class='select' title='xxx'>\r\n * </div>\r\n */\r\n(function (factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        define(['jquery'], factory);\r\n    } else if (typeof exports !== 'undefined') {\r\n        module.exports = factory(require('jquery'));\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n\r\n}(function ($) {\r\n    \"use strict\";\r\n    $.fn.datepicker = function (options) {\r\n        return $(this).each(function () {\r\n            datepicker($(this), options);\r\n        });\r\n    };\r\n\r\n    let datepicker = function (element, options) {\r\n\r\n        let settings = element.addonSettingExtend(options, {\r\n            type: element.property(\"type\", \"day\"),\r\n            addNum: element.property(\"add-num\", 0),\r\n            callback: ()=> {\r\n            }\r\n        });\r\n\r\n        let node = {\r\n            panel(){\r\n                return element.xPath(\".datepicker-panel\");\r\n            }\r\n        };\r\n\r\n        let func = {\r\n            setData(){\r\n                let dataStr = new date(settings.data).toString();\r\n                element.children(\"input\").val(dataStr);\r\n                node.panel().xPath(\".datepicker-panel-head>.text\").text(dataStr);\r\n                element.data(\"data\", settings.data);\r\n            },\r\n            drawPanelBody(){\r\n                node.panel().xPath(\".datepicker-panel-body\").html(()=> {\r\n                    let panelBodyHtml = \"<div class='week'>\";\r\n                    let headStr = [\"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\", \"sun\"];\r\n                    panelBodyHtml += headStr.map(d=> {\r\n                        d = \"<div class='week-head'>\" + d + \"</div>\";\r\n                        return d;\r\n                    }).join(\"\");\r\n                    panelBodyHtml += \"</div>\";\r\n\r\n                    let daysOfMonth = new date(settings.data).toDaysOfMonth();\r\n                    let daysOflastMonth = new date(settings.data).lastMonth().toDaysOfMonth();\r\n                    let first_DayOfWeek = new date(settings.data).firstDay().value.getDay();\r\n                    first_DayOfWeek = (first_DayOfWeek == 0) ? 7 : first_DayOfWeek;\r\n\r\n                    let currentDay = settings.data.getDate();\r\n                    let start = -first_DayOfWeek + 2;\r\n                    for (let i = 0; i < 6; i++) {\r\n                        let rowHtml = \"<div class='row'>\";\r\n                        for (let j = 0; j < 7; j++) {\r\n                            let n = i * 7 + j + start;\r\n                            let displayN;\r\n                            let classHtml = \"\";\r\n                            if (i == 0) {\r\n                                displayN = n < 1 ? (n + daysOflastMonth) : n;\r\n                                classHtml = n < 1 ? \" class='disabled'\" : \"\";\r\n                            } else {\r\n                                displayN = n > daysOfMonth ? (n - daysOfMonth) : n;\r\n                                classHtml = n > daysOfMonth ? \" class='disabled'\" : \"\";\r\n                            }\r\n                            if (currentDay == n) {\r\n                                classHtml = \" class='active'\";\r\n                            }\r\n\r\n                            rowHtml += \"<div\" + classHtml + \">\" + displayN + \"</div>\";\r\n                        }\r\n                        rowHtml += \"</div>\";\r\n                        panelBodyHtml += rowHtml;\r\n                    }\r\n                    return panelBodyHtml;\r\n                });\r\n\r\n                //listen day click\r\n                node.panel().xPath(\".datepicker-panel-body>.row>div\").delegate(\"\", \"click\", function () {\r\n                    let day = $(this).text();\r\n                    if ($(this).hasClass(\"disabled\")) {\r\n                        if (day < 10) {\r\n                            settings.data = new date(settings.data).addMonth(1).value;\r\n                        }\r\n                        if (day > 20) {\r\n                            settings.data = new date(settings.data).addMonth(-1).value;\r\n                        }\r\n                    } else {\r\n                        settings.data = new date(settings.data).value;\r\n                    }\r\n                    settings.data.setDate(day);\r\n                    func.setData();\r\n                    func.drawPanelBody();\r\n                    node.panel().hide();\r\n                    settings.callback();\r\n                });\r\n            }\r\n        };\r\n\r\n        element.addonInit(\"datepicker\", ()=> {\r\n            let dateStr = date.getLocalDay(settings.addNum);\r\n            dateStr = (settings.type == \"month\") ? dateStr.substr(0, 7) : dateStr;\r\n            let dataStr = (element.text() == \"\") ? dateStr : element.text();\r\n            settings.data = new date(dataStr).value;\r\n\r\n            // build html\r\n            element.append(function () {\r\n                let datepickerHtml = \"<input><button class='button-info'><i class='fa fa-calendar'></i></button>\";\r\n                datepickerHtml += \"<div class='datepicker-panel'>\";\r\n                datepickerHtml += \"<div class='datepicker-panel-head'><i class='fa fa-arrow-circle-left'></i><div class='text'>\";\r\n                datepickerHtml += dataStr + \"</div><i class='fa fa-arrow-circle-right'></i></div>\";\r\n                datepickerHtml += \"<div class='datepicker-panel-body'></div>\";\r\n                datepickerHtml += \"</div>\";\r\n                return datepickerHtml;\r\n            });\r\n\r\n            func.setData();\r\n            func.drawPanelBody();\r\n\r\n            element.children(\".button-info\").delegate(\"\", \"click\", function () {\r\n                node.panel().toggle();\r\n            });\r\n\r\n            node.panel().xPath(\".datepicker-panel-head>.fa-arrow-circle-left\").delegate(\"\", \"click\", function () {\r\n                let date1 = new date(settings.data);\r\n                settings.data = date1.addMonth(-1).value;\r\n                func.setData();\r\n                func.drawPanelBody();\r\n            });\r\n\r\n            node.panel().xPath(\".datepicker-panel-head>.fa-arrow-circle-right\").delegate(\"\", \"click\", function () {\r\n                let date1 = new date(settings.data);\r\n                settings.data = date1.addMonth(1).value;\r\n                func.setData();\r\n                func.drawPanelBody();\r\n            });\r\n\r\n            element.children(\"input\").delegate(\"\", \"blur\", function () {\r\n                let arr = $(this).val().split(\"-\");\r\n                let lastValue = new date(settings.data).toString();\r\n                if (arr.length != 3) {\r\n                    $(this).val(lastValue);\r\n                    return;\r\n                }\r\n                let [year,month,day] =[arr[0], arr[1], arr[2]];\r\n                let yearRegex = /^[1-2][0-9]{3}$/g;\r\n                let monthRegex = /(^[1][0-2]$)|(^[0][1-9]$)|(^[1-9]$)/g;\r\n                let dayRegex = /(^[1-2][0-9]$)|(^[3][0-1]$)|(^[0][1-9]$)|(^[1-9]$)/g;\r\n\r\n\r\n                if (yearRegex.test(year) && monthRegex.test(month) && dayRegex.test(day)) {\r\n                    settings.data = new date($(this).val()).value;\r\n                    func.setData();\r\n                }else {\r\n                    $(this).val(lastValue);\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        if (options == undefined) {\r\n            return;\r\n        }\r\n\r\n        if (options.data != undefined) {\r\n            if (options.data != \"\") {\r\n                settings.data = options.data;\r\n            }\r\n            func.setData();\r\n        }\r\n\r\n        return element;\r\n    }\r\n\r\n}));"]}